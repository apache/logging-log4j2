<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Plugins :: Apache Log4j</title>
    <link rel="canonical" href="https://logging.apache.org/log4j/2.x/manual/plugins.html">
    <meta name="generator" content="Antora 3.2.0-alpha.6">
<link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/../_images/favicon.ico" type="image/x-icon">
<!-- `@asciidoctor/tabs` extension styles -->
<link rel="stylesheet" href="../_/css/vendor/tabs.css">
<style>
  /* Swap colors of `IMPORTANT` and `WARNING` blocks */ 
  .doc .admonitionblock.important .icon { background-color: #f70; }
  .doc .admonitionblock.warning .icon { background-color: #e40046; }
  /* Default `h4`, `h5`, and `h6` are smaller than the normal text, fix header font sizing: */
  .doc h1 { font-size: 1.9rem; }
  .doc h2 { font-size: 1.7rem; }
  .doc h3 { font-size: 1.5rem; font-weight: 400; }
  .doc h4 { font-size: 1.3rem; font-weight: 500; }
  .doc h5 { font-size: 1.1rem; font-weight: 500; text-decoration: underline; }
  .doc h6 { font-size: 0.9rem; font-weight: 500; text-decoration: underline; }
  /* Default `code`, `pre`, and `.colist` (source code annotations) fonts are too big, adjust them: */
  .doc .colist>table code, .doc p code, .doc thead code { font-size: 0.8em; }
  .doc pre { font-size: 0.7rem; }
  .doc .colist { font-size: 0.75rem; }
  /* Make links more visible: */
  .doc a { text-decoration: underline; }
  .doc a code { text-decoration: underline; color: #1565c0; }
  /* Tab header fonts aren't rendered good, adjusting the font weight: */
  .tablist > ul li { font-weight: 500; }
  /* `page-toclevels` greater than 4 are not supported by Antora UI, patching it: */
  .toc .toc-menu li[data-level="4"] a {
    padding-left: 2.75rem;
  }
  /* Replace the default highlight.js color for strings from red (unnecessarily signaling something negative) to green: */
  .hljs-string {
    color: #0f8532;
  }
</style>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <img src="../_/../_images/logo-small-white.png" alt="Apache Log4j"/>
      </div>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://logging.apache.org">a subproject of&nbsp;<strong>Apache Logging Services</strong></a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ROOT" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Home</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../download.html">Download</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../release-notes.html">Release Notes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="https://logging.apache.org/support.html">Support</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://logging.apache.org/security.html">Security</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Manual</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="getting-started.html">Getting started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="api.html">API</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="api.html#loggers">Loggers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="eventlogging.html">Event Logger</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="simple-logger.html">Simple Logger</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="status-logger.html">Status Logger</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="logbuilder.html">Fluent API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="api.html#fish-tagging">Fish tagging</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="customloglevels.html">Levels</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="markers.html">Markers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="thread-context.html">Thread Context</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="messages.html">Messages</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="flowtracing.html">Flow Tracing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="implementation.html">Implementation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="architecture.html">Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="config-intro.html">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="configuration.html">Configuration file</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="systemproperties.html">Configuration properties</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="customconfig.html">Programmatic configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="appenders.html">Appenders</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="appenders/file.html">File appenders</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="appenders/rolling-file.html">Rolling file appenders</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="appenders/database.html">Database appenders</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="appenders/network.html">Network Appenders</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="appenders/message-queue.html">Message queue appenders</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="appenders/delegating.html">Delegating Appenders</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="layouts.html">Layouts</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="json-template-layout.html">JSON Template Layout</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="pattern-layout.html">Pattern Layout</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="lookups.html">Lookups</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="filters.html">Filters</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="scripts.html">Scripts</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="jmx.html">JMX</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="extending.html">Extending</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="plugins.html">Plugins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="performance.html">Performance</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="async.html">Asynchronous loggers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="garbagefree.html">Garbage-free logging</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugin-reference.html">Plugin reference</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../javadoc.html">Java API reference</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../faq.html">F.A.Q.</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../migrate-from-log4j1.html">Migrating from Log4j 1</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../migrate-from-logback.html">Migrating from Logback</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../migrate-from-slf4j.html">Migrating from SLF4J</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../hibernate.html">Integrating with Hibernate</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../jakarta.html">Integrating with Jakarta EE</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../soa.html">Integrating with service-oriented architectures</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../development.html">Development</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../components.html">Components</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-iostreams.html">Log4j IOStreams</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-spring-boot.html">Log4j Spring Boot Support</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-spring-cloud-config-client.html">Log4j Spring Cloud Configuration</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-jul.html">JUL-to-Log4j bridge</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../log4j-to-jul.html">Log4j-to-JUL bridge</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Related projects</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://logging.apache.org/log4j/jakarta/index.html">Log4j Jakarta EE</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://logging.apache.org/log4j/jmx-gui/index.html">Log4j JMX GUI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://logging.apache.org/log4j/kotlin/index.html">Log4j Kotlin</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://logging.apache.org/log4j/scala/index.html">Log4j Scala</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://logging.apache.org/log4j/tools/index.html">Log4j Tools</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://logging.apache.org/log4j/transform/index.html">Log4j Transformation Tools</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="index.html">Manual</a></li>
    <li><a href="implementation.html">Implementation</a></li>
    <li><a href="extending.html">Extending</a></li>
    <li><a href="plugins.html">Plugins</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/apache/logging-log4j2/edit/2.x/src/site/antora/modules/ROOT/pages/manual/plugins.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="4">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Plugins</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Log4j plugin system is the de facto extension mechanism embraced by various Log4j Core components.
Plugins make it possible for extensible components to <em>receive</em> feature implementations without any explicit links in between.
It is analogous to a <a href="https://en.wikipedia.org/wiki/Dependency_injection">dependency injection</a> framework, but curated for Log4j-specific needs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Log4j plugin system is implemented by Log4j Core, the logging implementation.
It is deliberately not a part of the Log4j API to keep the logging API footprint small.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Did you know about <strong><a href="../plugin-reference.html" class="xref page">Plugin reference</a>, the documentation extracted from the source code</strong> of all predefined Log4j plugins?
Like Javadoc, but specialized for plugins!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this section we will give an overview of the Log4j plugin system by answering certain questions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#declare-plugin">How can you declare a plugin?</a></p>
</li>
<li>
<p><a href="#core">How can you declare a plugin that needs to be represented in a Log4j configuration file?</a></p>
</li>
<li>
<p><a href="#plugin-registry">How can you register your plugin to Log4j?</a></p>
</li>
<li>
<p><a href="#plugin-discovery">How does Log4j discover plugins?</a></p>
</li>
<li>
<p><a href="#plugin-load">How can you load other plugins in a plugin?</a></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="declare-plugin"><a class="anchor" href="#declare-plugin"></a>Declaring plugins</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A class can be declared as a plugin by adding a <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/Plugin.html"><code>@Plugin</code></a> annotation, which is essentially composed of following attributes:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>name</code></dt>
<dd>
<p>Name of the plugin.
It is recommended to be distinct among plugins sharing the same <code>category</code>.
<code>name</code> matching is case-insensitive.</p>
</dd>
<dt class="hdlist1"><code>category</code> (optional)</dt>
<dd>
<p>A name used for grouping a set of plugins.
<code>category</code> matching is case-sensitive.</p>
</dd>
<dt class="hdlist1"><code>elementType</code> (deprecated)</dt>
<dd>
<p>We don&#8217;t recommend the usage of <code>elementType</code> anymore.
Existing usages are kept for backward compatibility reasons with the legacy configuration syntax: <code>&lt;appender type="ConsoleAppender"</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/apache/logging-log4j2/tree/2.x/log4j-core/src/main/java/org/apache/logging/log4j/core/lookup/LowerLookup.java"><code>LowerLookup.java</code></a> (a <a href="lookups.html" class="xref page">lookup</a> for lower-casing its input) for a simple example.</p>
</div>
<details>
<summary class="title">Click to read more on <strong>name collision</strong> and <strong>overriding an existing plugin</strong></summary>
<div class="content">
<div class="paragraph">
<p>The <code>name</code> attribute of plugins of a certain <code>category</code> is recommended to be distinct and this matching is case-insensitive.
In case of a name collision, a warning will be emitted, and the plugin <a href="#plugin-discovery">discovery order</a> will determine the effective plugin.
For example, to override the <code>File</code> plugin which is provided by the built-in <a href="appenders/file.html#FileAppender" class="xref page">File Appender</a>, you would need to place your plugin in a JAR file in the classpath ahead of Log4j Core JAR.
In an OSGi environment, the order that bundles are scanned for plugins generally follows the same order that bundles were installed into the framework; see
<a href="https://docs.osgi.org/javadoc/r6/core/org/osgi/framework/BundleContext.html#getBundles()"><code>getBundles()</code></a>
and
<a href="https://docs.osgi.org/javadoc/r6/core/org/osgi/framework/SynchronousBundleListener.html"><code>SynchronousBundleListener</code></a>.
In short, name collisions are even more unpredictable in an OSGi environment.</p>
</div>
</div>
</details>
</div>
</div>
<div class="sect1">
<h2 id="core"><a class="anchor" href="#core"></a>Declaring plugins represented in a configuration file</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If your plugin needs to be represented by an element in a configuration file (such as an <a href="appenders.html" class="xref page">appender</a>, <a href="layouts.html" class="xref page">layout</a>, <a href="api.html#loggers" class="xref page">logger</a>, or <a href="filters.html" class="xref page">filter</a>), following requirements must be met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>category</code> attribute of the <code>@Plugin</code> annotation must be set to <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/Node.html#CATEGORY"><code>Node.CATEGORY</code></a> (<code>Core</code>)</p>
</li>
<li>
<p>It must have a <a href="#declare-plugin-factory">plugin factory</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/apache/logging-log4j2/tree/2.x/log4j-layout-template-json/src/main/java/org/apache/logging/log4j/layout/template/json/JsonTemplateLayout.java"><code>JsonTemplateLayout.java</code></a> for an example and notice these details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>There are two plugin declarations: <code>JsonTemplateLayout</code> and <code>JsonTemplateLayout.EventTemplateAdditionalField</code></p>
</li>
<li>
<p>Both plugin declarations</p>
<div class="ulist">
<ul>
<li>
<p>Set the <code>category</code> attribute to <code>Node.CATEGORY</code></p>
</li>
<li>
<p>Provide a <code>@PluginBuilderFactory</code>-annotated static method</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="declare-plugin-factory"><a class="anchor" href="#declare-plugin-factory"></a>Declaring plugin factories</h3>
<div class="paragraph">
<p>A <strong>plugin factory</strong> is responsible for</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating an instance of the plugin</p>
</li>
<li>
<p>Receiving values (<code>Configuration</code> instance, configuration attributes, etc.) available in the context</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Every plugin that needs to be represented by an element in a configuration file must declare a plugin factory using one of the following:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">a <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/PluginFactory.html"><code>@PluginFactory</code></a>-annotated static method</dt>
<dd>
<p>What is expected to be received is modelled as method arguments.
Intended for simple plugins that receive less than a handful of values.</p>
<div class="paragraph">
<p>See <a href="https://github.com/apache/logging-log4j2/tree/2.x/log4j-core/src/main/java/org/apache/logging/log4j/core/layout/CsvParameterLayout.java"><code>CsvParameterLayout.java</code></a> for an example on <code>@PluginFactory</code> usage.</p>
</div>
</dd>
<dt class="hdlist1">a <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/PluginBuilderFactory.html"><code>@PluginBuilderFactory</code></a>-annotated static method of return type <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/util/Builder.html"><code>Builder&lt;T&gt;</code></a></dt>
<dd>
<p>What is expected to be received is modelled as fields of a builder class.
Intended for more sophisticated wiring needs.</p>
<details>
<summary class="title">Click for advantages of builder class over factory method</summary>
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Attribute names don&#8217;t need to be specified, if they match the field name</p>
</li>
<li>
<p>Default values can be specified in code rather than through an annotation.
This also allows a runtime-calculated default value, which isn&#8217;t allowed in annotations.</p>
</li>
<li>
<p>Default values are specified via code rather than relying on reflection and injection, so they work programmatically as well as in a configuration file.</p>
</li>
<li>
<p>Adding new optional parameters doesn&#8217;t require existing programmatic configuration to be refactored.</p>
</li>
<li>
<p>Easier to write unit tests using builders rather than factory methods with optional parameters.</p>
</li>
</ul>
</div>
</div>
</details>
<div class="paragraph">
<p>See <a href="https://github.com/apache/logging-log4j2/tree/2.x/log4j-layout-template-json/src/main/java/org/apache/logging/log4j/layout/template/json/JsonTemplateLayout.java"><code>JsonTemplateLayout.java</code></a> for an example on <code>@PluginBuilderFactory</code> usage.</p>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If a plugin class implements <code>Collection</code> or <code>Map</code>, then no factory method is used.
Instead, the class is instantiated using the default constructor, and all child configuration nodes are added to the <code>Collection</code> or <code>Map</code>.</p>
</div>
<div class="sect3">
<h4 id="attribute-types"><a class="anchor" href="#attribute-types"></a>Plugin factory attribute types</h4>
<div class="paragraph">
<p>To allow the current <code>Configuration</code> to populate the correct arguments for the <code>@PluginFactory</code>-annotated method (or fields for the builder class), every argument to the method must be annotated using one of the following attribute types.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/PluginAliases.html"><code>@PluginAliases</code></a></dt>
<dd>
<p>Identifies a list of aliases for a <code>@Plugin</code>, <code>@PluginAttribute</code>, or <code>@PluginBuilderAttribute</code></p>
</dd>
<dt class="hdlist1"><a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/PluginAttribute.html"><code>@PluginAttribute</code></a></dt>
<dd>
<p>Denotes a configuration element attribute.
The parameter must be convertible from a <code>String</code> using a <code>TypeConverter</code>.
Most built-in types are already supported, but custom <code>TypeConverter</code> plugins may also be provided for more type support.
Note that <code>PluginBuilderAttribute</code> can be used in builder class fields as an easier way to provide default values.</p>
</dd>
<dt class="hdlist1"><a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/PluginConfiguration.html"><code>@PluginConfiguration</code></a></dt>
<dd>
<p>The current <code>Configuration</code> object will be passed to the plugin as a parameter.</p>
</dd>
<dt class="hdlist1"><a id="PluginElement"></a> <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/PluginElement.html"><code>@PluginElement</code></a></dt>
<dd>
<p>The parameter may represent a complex object that itself has parameters that can be configured.
This also supports injecting an array of elements.</p>
</dd>
<dt class="hdlist1"><a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/PluginNode.html"><code>@PluginNode</code></a></dt>
<dd>
<p>The current <code>Node</code> being parsed will be passed to the plugin as a parameter.</p>
</dd>
<dt class="hdlist1"><a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/PluginValue.html"><code>@PluginValue</code></a></dt>
<dd>
<p>The value of the current <code>Node</code> or its attribute named <code>value</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Each attribute or element annotation must include the name that must be present in the configuration in order to match the configuration item to its respective parameter.
For plugin builders, the names of the fields will be used by default if no name is specified in the annotation.</p>
</div>
</div>
<div class="sect3">
<h4 id="type-converters"><a class="anchor" href="#type-converters"></a>Plugin factory attribute type converters</h4>
<div class="paragraph">
<p><a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/convert/TypeConverter.html"><code>TypeConverter</code></a>s are a certain group of plugins for converting <code>String</code>s read from configuration file elements into the types used in plugin factory attributes.
Other plugins can already be injected via <a href="#PluginElement">the <code>@PluginElement</code> annotation</a>; now, any type supported by <code>TypeConverter</code>s can be used in a <code>@PluginAttribute</code>-annotated factory attribute.</p>
</div>
<div class="paragraph">
<p>Conversion of enum types are supported on demand and do not require custom <code>TypeConverter</code>s.
A large number of built-in Java classes (<code>int</code>, <code>long</code>, <code>BigDecimal</code>, etc.) are already supported; see <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/convert/TypeConverters.html"><code>TypeConverters</code></a> for a more exhaustive listing.</p>
</div>
<div class="paragraph">
<p>You can create custom <code>TypeConverter</code>s as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Extend from <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/convert/TypeConverter.html">the <code>TypeConverter</code> interface</a></p>
</li>
<li>
<p>Set the <code>category</code> attribute of the <code>@Plugin</code> annotation to <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/convert/TypeConverters.html#CATEGORY"><code>TypeConverters.CATEGORY</code></a> (<code>TypeConverter</code>).
Unlike other plugins, the plugin name of a <code>TypeConverter</code> is purely cosmetic.</p>
</li>
<li>
<p>Have a default constructor</p>
</li>
<li>
<p>Optionally, extend from <code>Comparable&lt;TypeConverter&lt;?&gt;&gt;</code>, which will be used for determining the order in case of multiple <code>TypeConverter</code> candidates for a certain type</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/apache/logging-log4j2/tree/2.x/log4j-core/org/apache/logging/log4j/core/config/plugins/convert/TypeConverters.java"><code>TypeConverters.java</code></a> for example implementations.</p>
</div>
</div>
<div class="sect3">
<h4 id="constraint-validators"><a class="anchor" href="#constraint-validators"></a>Plugin factory attribute validators</h4>
<div class="paragraph">
<p>Plugin factory fields and parameters can be automatically validated at runtime using constraint validators inspired by <a href="https://beanvalidation.org">Bean Validation</a>.
The following annotations are bundled in Log4j, but custom <code>ConstraintValidator</code> can be created as well.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/validation/constraints/Required.html"><code>@Required</code></a></dt>
<dd>
<p>This annotation validates that a value is non-empty.
This covers a check for null as well as several other scenarios: empty <code>CharSequence</code> objects, empty arrays, empty <code>Collection</code> instances, and empty <code>Map</code> instances.</p>
</dd>
<dt class="hdlist1"><a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/validation/constraints/ValidHost.html"><code>@ValidHost</code></a></dt>
<dd>
<p>This annotation validates that a value corresponds to a valid host name.
This uses the same validation as <a href="https://docs.oracle.com/javase/8/docs/api/java/net/InetAddress.html#getByName-java.lang.String-"><code>InetAddress.getByName(String)</code></a>.</p>
</dd>
<dt class="hdlist1"><a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/validation/constraints/ValidPort.html"><code>@ValidPort</code></a></dt>
<dd>
<p>This annotation validates that a value corresponds to a valid port number between 0 and 65535.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="plugin-registry"><a class="anchor" href="#plugin-registry"></a>Registering plugins</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Registering plugins are done by placing a <strong>Log4j plugin descriptor</strong> (i.e., <code>Log4j2Plugins.dat</code>) into the classpath.
This file is generated using the <a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/processor/PluginProcessor.html"><code>PluginProcessor</code></a> annotation processor at compile-time.
You need to configure your build tool as follows to employ <code>PluginProcessor</code> by the Java compiler:</p>
</div>
<div id="_tabs_1" class="openblock tabs is-sync is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_1_maven" class="tab">
<p>Maven</p>
</li>
<li id="_tabs_1_gradle" class="tab">
<p>Gradle</p>
</li>
</ul>
</div>
<div id="_tabs_1_maven--panel" class="tabpanel" aria-labelledby="_tabs_1_maven">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;plugin&gt;
  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
  &lt;version&gt;${maven-compiler-plugin.version}&lt;/version&gt;
  &lt;executions&gt;
    &lt;execution&gt;
      &lt;id&gt;generate-log4j-plugin-descriptor&lt;/id&gt;
      &lt;goals&gt;
        &lt;goal&gt;compile&lt;/goal&gt;
      &lt;/goals&gt;
      &lt;phase&gt;process-classes&lt;/phase&gt;
      &lt;configuration&gt;
        &lt;proc&gt;only&lt;/proc&gt;
        &lt;annotationProcessorPaths&gt;
          &lt;!-- Include `log4j-core` providing `org.apache.logging.log4j.core.config.plugins.processor.PluginProcessor` that generates `Log4j2Plugins.dat` --&gt;
          &lt;path&gt;
            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
            &lt;version&gt;2.23.1&lt;/version&gt;
          &lt;/path&gt;
        &lt;/annotationProcessorPaths&gt;
        &lt;annotationProcessors&gt;
          &lt;!-- Process sources using `org.apache.logging.log4j.core.config.plugins.processor.PluginProcessor` to generate `Log4j2Plugins.dat` --&gt;
          &lt;processor&gt;org.apache.logging.log4j.core.config.plugins.processor.PluginProcessor&lt;/processor&gt;
        &lt;/annotationProcessors&gt;
      &lt;/configuration&gt;
    &lt;/execution&gt;
  &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
</div>
<div id="_tabs_1_gradle--panel" class="tabpanel" aria-labelledby="_tabs_1_gradle">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencies {
  // Process sources using `log4j-core` providing `org.apache.logging.log4j.core.config.plugins.processor.PluginProcessor` that generates `Log4j2Plugins.dat` --&gt;
  annotationProcessor('org.apache.logging.log4j:log4j-core:2.23.1')
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="plugin-discovery"><a class="anchor" href="#plugin-discovery"></a>Discovering plugins</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/util/PluginManager.html"><code>PluginManager</code></a> is responsible for discovering plugins and loading their descriptions.
It locates plugins by looking in following places in given order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Plugin descriptor files on the classpath (using the class loader that loaded the <code>log4j-core</code> artifact).
These files are generated automatically at compile-time by the Log4j plugin annotation processor.
See <a href="#plugin-registry">Registering plugins</a> for details.</p>
</li>
<li>
<p><strong>[OSGi only]</strong> Serialized plugin listing files in each active OSGi bundle.
A <code>BundleListener</code> is added on activation to continue checking new bundles after Log4j Core has started.</p>
</li>
<li>
<p><strong>[Deprecated]</strong> A comma-separated list of packages specified by the <code>log4j.plugin.packages</code> system property</p>
</li>
<li>
<p><strong>[Deprecated]</strong> Packages passed to the static <code>PluginManager.addPackages()</code> method before Log4j configuration takes place</p>
</li>
<li>
<p><strong>[Deprecated]</strong> The <code>packages</code> attribute declared at the root element of your Log4j configuration file</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="plugin-load"><a class="anchor" href="#plugin-load"></a>Loading plugins</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is pretty common that a plugin uses other plugins; appenders accept layouts, some layouts accept key-value pairs, etc.
You can do this as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If your plugin has a <a href="#declare-plugin-factory">plugin factory</a> (i.e., it is represented by a configuration file element), you can use <a href="#PluginElement">the <code>@PluginElement</code> annotation</a> to receive other plugins.
See <code>@PluginElement("EventTemplateAdditionalField")</code> usage in <a href="https://github.com/apache/logging-log4j2/tree/2.x/log4j-layout-template-json/src/main/java/org/apache/logging/log4j/layout/template/json/JsonTemplateLayout.java"><code>JsonTemplateLayout.java</code></a> for an example.</p>
</li>
<li>
<p>Otherwise, you can use
<a href="../javadoc/log4j-core/org/apache/logging/log4j/core/config/plugins/util/PluginUtil.html"><code>PluginUtil</code></a>,
which is a convenient wrapper around <a href="#plugin-discovery"><code>PluginManager</code></a>, to discover and load plugins.
See <a href="https://github.com/apache/logging-log4j2/tree/2.x/log4j-layout-template-json/src/main/java/org/apache/logging/log4j/layout/template/json/resolver/TemplateResolverFactories.java"><code>TemplateResolverFactories.java</code></a> for example usages.</p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>
    Copyright Â© 1999-2024 <a href="https://www.apache.org/">The Apache Software Foundation</a>.
    Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache Software License, Version 2.0</a>.
    Please read our <a href="https://privacy.apache.org/policies/privacy-policy-public.html">privacy policy</a>.
  </p>
  <p>
    Apache, Log4j, and the Apache feather logo are trademarks or registered trademarks of The Apache Software Foundation.
    Oracle and Java are registered trademarks of Oracle and/or its affiliates.
    Other names may be trademarks of their respective owners.
  </p>
</footer>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
<!-- `@asciidoctor/tabs` extension scripts -->
<script async src="../_/js/vendor/tabs.js"></script>
  </body>
</html>
